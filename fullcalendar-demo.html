<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />


  <title>
    Hebcal FullCalendar demo
  </title>

  <style>

    html, body {
      margin: 0;
      padding: 0;
      font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
      font-size: 14px;
    }

    #calendar {
      max-width: 1000px;
      margin: 40px auto;
    }

.fc-event.hebdate, .fc-event.omer,
.fc-event.hebdate:hover, .fc-event.omer:hover {
 background-color:#FFF;
 border-color:#FFF;
 color:#999;
}
.fc-event.dafyomi, .fc-event.dafyomi:hover {
 background-color:#FFF;
 border-color:#FFF;
 color:#08c;
}
.fc-event.dafyomi a {
 color: #0088cc;
}
.fc-event.dafyomi a:hover,
.fc-event.dafyomi a:focus {
 color: #005580;
}
.fc-event.candles, .fc-event.havdalah,
.fc-event.candles:hover, .fc-event.havdalah:hover {
 background-color:#FFF;
 border-color:#FFF;
 color:#333;
}
.fc-event.holiday {
 background-color:#3a87ad;
 border-color:#3a87ad;
 color:#FFF;
}
.fc-event.holiday.yomtov {
 background-color:#ffd446;
 border-color:#ffd446;
 color:#333;
}
.fc-event.parashat {
 background-color:#257e4a;
 border-color:#257e4a;
 color:#FFF;
}
.fc-event.hebrew .fc-title {
 font-family:'Alef Hebrew','SBL Hebrew',David;
 font-size:110%;
 font-weight:normal;
 direction:rtl;
}
.fc-event.hebrew .fc-time {
 direction:ltr;
 unicode-bidi: bidi-override;
}

  </style>

<link href='https://unpkg.com/@fullcalendar/core@4.4.2/main.min.css' rel='stylesheet' />  
<link href='https://unpkg.com/@fullcalendar/daygrid@4.4.2/main.min.css' rel='stylesheet' />

<script src='https://unpkg.com/@fullcalendar/core@4.4.2/main.min.js'></script>
<script src='https://unpkg.com/@fullcalendar/daygrid@4.4.2/main.min.js'></script>

<script src="https://unpkg.com/@popperjs/core@2"></script>
<script src="https://unpkg.com/tippy.js@6"></script>

<!-- hebcal-->
<script src='./node-process-browser.js'></script>
<script src='./node_modules/@hebcal/core/dist/bundle.js'></script>
<script src='./dist/bundle.min.js'></script>
<script>

  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var location = hebcal__core.Location.lookup('Helsinki');
    var calendar = window['hebcalFullCalendar'] = new FullCalendar.Calendar(calendarEl, {
      plugins: [ 'dayGrid' ],
      defaultView: 'dayGridMonth',
      header: {
        left: 'title',
        right: 'prev,next today',
      },
      timeZone: location.getTzid(),
      events: function(info, successCallback, failureCallback) {
        const options = {
          start: info.start,
          end: info.end,
          isHebrewYear: false,
          candlelighting: true,
          location: location,
          il: false,
          sedrot: true,
          dafyomi: true,
          omer: true,
          locale: 'ashkenazi',
          addHebrewDates: true,
        };
        const events = hebcal__core.HebrewCalendar.calendar(options);
        const fcEvents = events.map((ev) => hebcal__rest_api.eventToFullCalendar(ev, location.tzid));
        for (let i = 0; i < fcEvents.length; i++) {
          if (fcEvents[i].hebrew) {
            fcEvents[i].title += '\n' + fcEvents[i].hebrew;
          }
        }
        successCallback(fcEvents);
      },
      eventRender: function(info) {
        if (info.event.extendedProps.description) {
          tippy(info.el, {
            content: info.event.extendedProps.description,
            allowHTML: true,
          });
        }
      },
    });
    calendar.render();
  });

  document.addEventListener('keydown', function(e) {
        if (e.keyCode == 37) {
          window['hebcalFullCalendar'].prev();
        } else if (e.keyCode == 39) {
          window['hebcalFullCalendar'].next();
        }
    });


</script>

</head>
<body>
<h1>Hebcal</h1>
  <div id='calendar'></div>
</body>

</html>
